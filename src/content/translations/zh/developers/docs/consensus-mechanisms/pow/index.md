---
title: 工作量证明 (PoW)
description: 工作量证明共识协议的解释及其在以太坊中的作用。
lang: zh
sidebar: true
incomplete: true
---

类似于比特币，以太坊目前使用的共识协议被称为**[工作量证明 (PoW)](https://wikipedia.org/wiki/Proof_of_work)**。 这种机制允许以太坊网络的节点就以太坊区块链上记录的所有信息的状态达成共识，并防止某些产生经济影响的攻击。

在接下来一年，工作量证明将被逐步淘汰，这有利于**[权益证明 (PoS)](/developers/docs/consensus-mechanisms/pos)** 的发展。 向权益证明 (PoS) 的过渡也将从以太坊逐步淘汰挖矿机制。 如果想了解更多时间表详情，请查看 [Eth2 合并升级](/upgrades/merge/) 的进度。

## 前置要求 {#prerequisites}

为了更好地了解此页面，推荐先阅读[交易](/developers/docs/transactions/)、[区块](/developers/docs/blocks/)和[共识机制](/developers/docs/consensus-mechanisms/)。

## 什么是工作量证明 (POW) {#what-is-pow}

工作量证明是一种允许去中心化的以太坊网络达成共识或者一致认可帐户余额和交易顺序的机制。 这个机制防止用户“双花”他们的币，同时确保极难攻击或操作以太坊的链。

## 工作量证明和挖矿 {#pow-and-mining}

工作量证明是一个为矿工设置挖矿难度和规则的基础性算法。 挖矿就是“工作”本身。 挖矿是向区块链中添加有效区块。 这个工作很重要，因为区块链的长度帮助网络识别出有效的以太坊链并且理解当前以太坊的状态。 完成的“工作”越多链越长，区块链的序号就越大，网络就能更加确定当前链和区块的状态。

[关于挖矿的更多信息](/developers/docs/consensus-mechanisms/pow/mining/)

## 以太坊的工作量证明机制是如何运作的？ {#how-it-works}

以太坊的交易被处理为区块。 每个区块都具备以下内容：

- 区块的难度，例如：3,324,092,183,262,715
- 混合哈希（mixHash），例如：`0x44bca881b07a6a09f83b130798072441705d9a665c5ac8bdf2f39a3cdf3bee29`
- nonce--例如：`0xd3ee432b4fb3d26b`

区块数据与工作量证明直接关联。

### 工作量证明机制 {#the-work}

工作量证明协议 (Ethash)，要求矿工经过激烈的试错竞赛，找到一个区块的随机数。 只有具备有效随机数的区块才能被加入区块链中。

通过比赛创建区块时，矿工将反复放置一个数据集，只能通过数学函数从下载和运行完整链（像矿工那样）中获得数据集。 这是为了根据区块所声明的难度，生成一个低于目标随机数的混合哈希。 做到这些的最佳途径就是试错。

难度决定了该哈希的目标。 目标越小，有效的哈希值的集合就越小。 一旦生成哈希，其他矿工和客户就很容易校验哈希。 即使一个交易记录出现改变，整个哈希就会变得完全不同，表示出现欺诈。

哈希使得交易欺诈性的交易更容易发现。 此外，工作量证明作为一个流程，同样有效威慑了对区块链的攻击。

### 工作量证明和安全性 {#security}

在以太坊主链上工作的矿工会因挖矿获得回报。 对于一部分旷工而言，他们几乎没有理由去开辟一条自己的新链 - 因为这破坏了系统。 区块链依赖于将单一状态来作为真实性来源。 同时，使用者要始终选择最长的或者“最重”的链。

工作量证明机制是为了扩展链。 最长的链最可信，因为它完成的计算工作最多。 在以太坊的 PoW 系统中，几乎无法创建一个新区块以擦除交易信息、创建假区块或者维持第二个链。 这是因为恶意矿工需要比其他所有人更快地计算出区块随机数。

要一直创建恶意但有效的区块，就需要有超过 51% 的全网采矿算力去打败其他人。 这项“工作”需要大量算力才能完成。 而能源支出可能甚至超出攻击所取得的收益。

### 工作量证明的经济模型 {#economics}

工作量证明还负责在系统中发行新币，并鼓励矿工参与这项工作。

将为成功创建区块的矿工奖励 2 个新铸造的 ETH 和这个区块内所有的交易费用。 矿工通过计算叔块也可以获得 1.75 个 ETH。 叔块是矿工在另一个矿工出块的同时创建的有效块。 叔块通常由于网络延迟导致。

## 终局性 {#finality}

如果交易属于一个无法更改的区块时，它就在以太坊上具有“确定性”。

由于矿工分散工作，可以同时开采出两个有效区块。 这创建了临时分叉。 最后，在挖出并添加后续区块，使其中一条链更长时，这条链就会成为被接受的链。

但更复杂的是，在临时分叉上被拒绝的交易将会记录在被接受的主链上。 这意味着区块可逆。 因此，确定性是指您在认为交易不可逆之前需要等待的一段时间。 以太坊推荐的时间是等待 6 个区块或者超过 1 分钟。 6 个区块后，您可以相对稳妥地说交易成功了。 当然，您也可以等待更长的时间，这样更有保障。

在设计去中心化应用时，应始终牢记确定性。 如果将交易信息误报给用户，特别当交易价值很高时，这将严重有损用户体验。

请记住，这个时间不包含等待矿工处理交易的时间。

## 工作量证明能源消耗 {#energy}

对工作证明提出的一项主要批评是保持网络安全所需的能源消耗。 为了维持安全性和去中心化，以太坊工作量证明每年消耗 73.2 太瓦时的能源，这相当于奥地利这样的中等国家的能耗。

## 优点和缺点 {#pros-and-cons}

| 优点                                                                                                                                                           | 缺点                                                               |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ |
| 工作量证明并无对错。 你不需要 ETH 来启动，区块允许你从 0ETH 获得正的收益。 在[权益证明](/developers/docs/consensus-mechanisms/pos/)中，您需要 ETH 去启动挖矿。 | 工作量证明消耗了大量能源，对环境不利。                             |
| 工作量证明是一个经过考验和测试的共识机制，多年来一直保持了比特币和以太坊的安全性和去中心化。                                                                   | 如果你想要采矿，你需要花大量的资金去购买专业设备。                 |
| 与权益证明方式相比，PoW 是比较容易实施的。                                                                                                                     | 因为算力的不断增加，矿池可能会主导挖矿过程，导致中心化和安全风险。 |

## 与权益证明对比 {#compared-to-pos}

从更高层面上看，权益证明 (PoS) 和工作量证明 (PoW) 的最终目标相同，即帮助去中心化网络安全地达成共识。 但他们在实现方式和人员上有些不同：

- 权益证明 (PoS) 让质押 ETH 不再需要算力。
- 权益证明 (PoS) 将矿工替换为验证者。 验证者通过质押他们的 ETH 来创建新的区块。
- 验证者不会竞争创建区块，而是由算法随机选择。
- 终局性是很清晰的：在特定的检查节点，如果 2/3 验证者确定了区块，这个区块将被视为最终状态。 验证者必须在区块压上自己全部质押，因此如果他们试图串通更改区块链，他们就会失去他们的全部质押。

[关于权益证明 (PoS) 的更多信息](/developers/docs/consensus-mechanisms/pos/)

## 更偏向视频学习者？ {#visual-learner}

<YouTube id="3EUAcxhuoU4" />

## 延伸阅读 {#further-reading}

- [多数攻击](https://en.bitcoin.it/wiki/Majority_attack/)
- [关于结算终局性](https://blog.ethereum.org/2016/05/09/on-settlement-finality/)

### 视频 {#videos}

- [对工作量证明协议的技术说明](https://youtu.be/9V1bipPkCTU)

## 相关主题 {#related-topics}

- [采矿](/developers/docs/consensus-mechanisms/pow/mining/)
- [权益证明](/developers/docs/consensus-mechanisms/pos/)
